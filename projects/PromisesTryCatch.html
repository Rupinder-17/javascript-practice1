<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css"
    />
    <script
      type="text/javascript"
      src="https://cdn.jsdelivr.net/npm/toastify-js"
    ></script>
  </head>
  <body>
    <div class="border w-96 m-auto py-5 bg-gray-100 shadow-lg mt-6">
      <h2 class="text-center font-medium text-3xl text-blue-400">FOOD ITEMS</h2>
      <ul id="list" class="px-7 py-4"></ul>
      <button id="placeOrder" class="bg-blue-800 ml-4 px-5 py-1 text-gray-200">
        Place Order
      </button>
    </div>

    <script>
      let foodItem = [
        {
          id: 1,
          item: "Noodles",
          status: false,
        },
        {
          id: 2,
          item: "Burgur",
          status: false,
        },
        {
          id: 3,
          item: "Salad",
          status: false,
        },
        {
          id: 4,
          item: "Pizza",
          status: false,
        },
        {
          id: 5,
          item: "Cook",
          status: false,
        },
      ];
      const list = document.getElementById("list");
      const placeOrder = document.getElementById("placeOrder");
      placeOrder.addEventListener("click", startProcess);

      const renderFoodList = (food) => {
        list.innerHTML = " ";
        foodItem.map((element) => {
          const foodList = `<li class="flex gap-4" >
            <span>
            <input type="checkbox" ${
              element.status ? "checked" : ""
            } id="" onclick="checkList(${element.id})">

                 </span>
                    <p>${element.item}</p>
                    </li>`;

          list.innerHTML += foodList;
        });
      };

      const checkList = (id) => {
        foodItem = foodItem.map((elm) =>
          elm.id === id ? { ...elm, status: !elm.status } : elm
        );
      };
      function orderList(foodId) {
        return new Promise((res, rej) => {
          const checkedList = foodItem.filter((item) => item.status);
          if (checkedList.length > 0) {
            const checkItemNames = checkedList.map((foodItem) => foodItem.item);
            setTimeout(function () {
              res(`your order ${checkItemNames} is placed`);
            }, 3000);
          } else {
            rej("error, there is no order any fooditem");
          }
        });
      }

      function foodPrepear(id) {
        return new Promise((res) => {
          setTimeout(function () {
            res(`your order  is ready`);
          }, 4000);
        });
      }

      function foodPickUp(id) {
        return new Promise((res) => {
          setTimeout(function () {
            res("your order is pickup by driver");
          }, 5000);
        });
      }
      function foodDilvery(id) {
        return new Promise((res) => {
          setTimeout(function () {
            res("your order is successfully dilver");
          }, 4000);
        });
      }

      async function startProcess(order) {
        try {
          const orderPlaced = orderList(order);
          const foodPrepared = foodPrepear(order.id);
          const foodPick = foodPickUp(order.id);
          const foodDilver = foodDilvery(order.id);

          const result = await Promise.all([
            orderPlaced,
            foodPrepared,
            foodPick,
            foodDilver,
          ]);

          result.forEach((item) =>
            Toastify({
              text: item,
              duration: 3000,
              style: {
                background: "linear-gradient(to right, blue, #96c94d)",
              },
            }).showToast()
          );
        } catch (error) {
            Toastify({
              text: error,
              duration: 3000,
              style: {
                background: "linear-gradient(to right, blue, #96c94d)",
              },
            }).showToast()
        }
      }
      fetch('https://fakestoreapi.com/products')
            .then(res=>res.json())
            .then(json=>console.log(json))
            // write the sum of two numbers 
            


      renderFoodList(foodItem);
    </script>
  </body>
</html>
